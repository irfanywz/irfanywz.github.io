{{ define "head" }}
<style>
    .quote-content p {
        margin-bottom: 1rem;
    }
</style>
{{ end }}

{{ define "main" }}
<main class="flex-grow bg-white dark:bg-gray-900 transition-colors duration-300"
    x-data="{ 
        activeFilter: new URLSearchParams(window.location.search).get('filter') || 'all',
        updateFilter(filter) {
            this.activeFilter = filter;
            const url = new URL(window.location);
            if (filter === 'all') {
                url.searchParams.delete('filter');
            } else {
                url.searchParams.set('filter', filter);
            }
            window.history.pushState({}, '', url);
        },
        copyToClipboard(text, $el) {
            navigator.clipboard.writeText(text).then(() => {
                const originalIcon = $el.innerHTML;
                $el.innerHTML = '<i class=\'icon-[ri--check-line] text-green-500\'></i>';
                setTimeout(() => {
                    $el.innerHTML = originalIcon;
                }, 2000);
            });
        }
    }"
    @popstate.window="activeFilter = new URLSearchParams(window.location.search).get('filter') || 'all'">

    <div class="max-w-5xl mx-auto px-4 py-16">

        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4 flex items-center justify-center gap-3">
                <span class="icon-[ri--double-quotes-l] w-10 h-10 text-yellow-500"></span>
                {{ .Title }}
            </h1>
            <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                {{ .Description }}
            </p>
        </header>

        <div class="flex flex-wrap justify-center gap-2 mb-12">
            <button 
                @click="updateFilter('all')"
                :class="activeFilter === 'all' ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700'"
                class="px-5 py-2 rounded-full border text-sm font-medium transition-all duration-200 shadow-sm">
                Semua
            </button>
            
            {{ $allCategories := slice }}
            {{ range .Pages }}
                {{ with .Params.categories }}
                    {{ $allCategories = $allCategories | append . }}
                {{ end }}
            {{ end }}
            
            {{ $uniqueCategories := uniq (sort $allCategories) }}
            {{ range $uniqueCategories }}
                <button 
                    @click="updateFilter('{{ . }}')"
                    :class="activeFilter === '{{ . }}' ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700'"
                    class="px-5 py-2 rounded-full border text-sm font-medium transition-all duration-200 shadow-sm">
                    {{ . }}
                </button>
            {{ end }}
        </div>

        <div class="columns-1 sm:columns-2 lg:columns-3 gap-6 space-y-6">
            {{ range .Pages }}
            <article 
                x-show="activeFilter === 'all' || '{{ delimit .Params.categories "|" }}'.split('|').includes(activeFilter)"
                x-transition.opacity.duration.300ms
                class="break-inside-avoid bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 hover:shadow-md transition-all duration-300">
                
                <div class="text-gray-600 dark:text-gray-300 leading-relaxed mb-6 quote-content text-lg font-sans">
                    {{ .Content | safeHTML }}
                </div>
                
                <div class="flex items-end justify-between pt-4 border-t border-gray-100 dark:border-gray-700">
                    <div>
                        <div class="font-bold text-gray-900 dark:text-white">
                        {{ with .Params.author }}
                            {{ . }}
                        {{ else }}
                            Anonymous
                        {{ end }}
                        </div>
                        <div class="text-xs text-gray-400 mt-1">{{ .Date | time.Format "2 January 2006" }}</div>
                    </div>
                    <button 
                        @click='copyToClipboard({{ .Plain | jsonify }}, $el)'
                        class="p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700" 
                        title="Salin kutipan">
                        <i class="icon-[ri--file-copy-line] text-xl"></i>
                    </button>
                </div>
            </article>
            {{ end }}
        </div>
    </div>
</main>
{{ end }}

{{ define "footer" }}
{{ end }}